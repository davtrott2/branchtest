template_name: "Template for Docker Hub"
template_version: 1.0
description: Launch any container from Docker Hub
long_description: Docker Template for custom launches.

imports:
  - base_types.yaml
  - docker_base.yaml

topology_template:
  inputs:
    image_name:
      type: string
      description: Docker Hub image name
      properties:
        displayName: Image Name
    image_tag:
      type: string
      default: latest
      description: Docker Hub image tag
      properties:
        displayName: Image Tag
  node_templates:
    docker_app:
      type: dcm.nodes.DockerApp
      properties:
        image: {get_input: image_name}
        tag: {get_input: image_tag}
        ports: [80, 443, 3306]
        portBindings:
          80: [['0.0.0.0', 80]]
          443: [['0.0.0.0', 443]]
          3306: [['0.0.0.0', 3306]]
        environmentVariables: {}
      requirements:
        - host: vm

    vm_firewall_rules:
      type: blueprint_firewall
      properties:
        rules:
          - remote_ip_prefix: 0.0.0.0/0
            port: 22
          - remote_ip_prefix: 0.0.0.0/0
            port: 80
          - remote_ip_prefix: 0.0.0.0/0
            port: 443

  outputs:
    link:
      type: string
      value: {get_attribute: [vm, publicIpAddress]}
      properties:
        displayName: IP
